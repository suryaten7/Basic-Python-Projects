# -*- coding: utf-8 -*-
"""xgboost using iris dataset

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1S9bjNneXmlpEQ4zfcRCycUjVSMeC0hlG
"""

from sklearn.datasets import load_iris

iris=load_iris()

import pandas as pd

df=pd.DataFrame(iris["data"],columns=iris["feature_names"])

df.head()

iris.keys()

sample,feature=iris.data.shape

print(sample)

print(feature)

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split( iris.data, iris.target, test_size=0.30, random_state=42)

import xgboost as xgb

train=xgb.DMatrix(X_train,label=y_train)
test=xgb.DMatrix(X_test,label=y_test)

params={
    "max_depth":4,
    "eta":0.3,
    "objective":"multi:softmax",
    "num_class":3
}
epochs=10

model=xgb.train(params,train,epochs)

pred=model.predict(test)

print(pred)

len(pred)

from sklearn.metrics import accuracy_score

accuracy_score(y_test,pred)